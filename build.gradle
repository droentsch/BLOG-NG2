plugins {
    id "com.moowork.node" version "0.11"
}
apply plugin:'base'

node {
    version = '6.10.0'
    npmVersion = '3.10.10'
    download = true
}

task wrapper(type:Wrapper) {
    gradleVersion = '4.8'
}

def getTimestamp() {
    def date = new Date()
    return date.format('yyyyMMdd.HHmm')
}

def t = getTimestamp();

if (project.hasProperty('tag')) {
    t = tag;
}
def version = { tag -> "--tag=${tag}" }

task rebuild(type: NpmTask) {
    args = ['run', 'build', '--', version(t) ]
}

task rebuildMin(type: NpmTask) {
    args = ['run', 'build:minified', '--', version(t) ]
}

task lint(type: NpmTask) {
    args = ['run', 'lint']
}

task test(type: NpmTask) {
    args = ['run', 'test']
}
